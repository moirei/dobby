<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Conventions | Dobby</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/dobby/logo.png">
    <link rel="apple-touch-icon" href="/dobby/icons/apple-touch-icon-152x152.png">
    <meta name="description" content="GraphQL data models made easy.">
    <meta property="og:site_name" content="Dobby">
    <meta property="og:title" content="Conventions">
    <meta property="og:type" content="website">
    <meta property="og:url" content="/guide/models/conventions.html">
    <meta name="twitter:title" content="Conventions">
    <meta name="twitter:url" content="/guide/models/conventions.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/dobby/assets/css/0.styles.dfa1a5cf.css" as="style"><link rel="preload" href="/dobby/assets/js/app.d1fa0665.js" as="script"><link rel="preload" href="/dobby/assets/js/2.0c3bff11.js" as="script"><link rel="preload" href="/dobby/assets/js/11.ba11236c.js" as="script"><link rel="prefetch" href="/dobby/assets/js/10.c8a66029.js"><link rel="prefetch" href="/dobby/assets/js/12.ff9a7298.js"><link rel="prefetch" href="/dobby/assets/js/13.c7120bd2.js"><link rel="prefetch" href="/dobby/assets/js/14.22eb13c3.js"><link rel="prefetch" href="/dobby/assets/js/15.715851fc.js"><link rel="prefetch" href="/dobby/assets/js/16.8fbed22f.js"><link rel="prefetch" href="/dobby/assets/js/17.78ff0958.js"><link rel="prefetch" href="/dobby/assets/js/18.9ff9f214.js"><link rel="prefetch" href="/dobby/assets/js/19.164b8e25.js"><link rel="prefetch" href="/dobby/assets/js/20.3f73a18f.js"><link rel="prefetch" href="/dobby/assets/js/21.5e75273a.js"><link rel="prefetch" href="/dobby/assets/js/22.4ba21d7e.js"><link rel="prefetch" href="/dobby/assets/js/23.5cc52852.js"><link rel="prefetch" href="/dobby/assets/js/24.5a7ec6d9.js"><link rel="prefetch" href="/dobby/assets/js/3.396b1a95.js"><link rel="prefetch" href="/dobby/assets/js/4.6cf1e0cf.js"><link rel="prefetch" href="/dobby/assets/js/5.1214c687.js"><link rel="prefetch" href="/dobby/assets/js/6.16373f7f.js"><link rel="prefetch" href="/dobby/assets/js/7.5f58fcfe.js"><link rel="prefetch" href="/dobby/assets/js/8.7044b974.js"><link rel="prefetch" href="/dobby/assets/js/9.d306db64.js">
    <link rel="stylesheet" href="/dobby/assets/css/0.styles.dfa1a5cf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/dobby/" class="home-link router-link-active"><!----> <span class="site-name">Dobby</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/dobby/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/dobby/installation.html" class="nav-link">
  Guide
</a></div> <a href="https://github.com/moirei/dobby" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/dobby/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/dobby/installation.html" class="nav-link">
  Guide
</a></div> <a href="https://github.com/moirei/dobby" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/dobby/configuration.html" class="sidebar-link">Configuration</a></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Models</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dobby/guide/models/define-models.html" class="sidebar-link">Defining Models</a></li><li><a href="/dobby/guide/models/conventions.html" aria-current="page" class="active sidebar-link">Conventions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#model-key" class="sidebar-link">Model Key</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#primary-keys" class="sidebar-link">Primary Keys</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#default-selects" class="sidebar-link">Default Selects</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#eager-loading" class="sidebar-link">Eager Loading</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#dynamic-query-operations" class="sidebar-link">Dynamic Query Operations</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#default-attribute-values" class="sidebar-link">Default Attribute Values</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#maximum-query-depth" class="sidebar-link">Maximum Query Depth</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#make-arguments-required-by-default" class="sidebar-link">Make Arguments Required by Default</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#fetch-policy" class="sidebar-link">Fetch Policy</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#attribute-changes" class="sidebar-link">Attribute Changes</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#copying-and-hydration" class="sidebar-link">Copying and Hydration</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#comparing-models" class="sidebar-link">Comparing Models</a></li><li class="sidebar-sub-header"><a href="/dobby/guide/models/conventions.html#retrieving-instance-constructor" class="sidebar-link">Retrieving Instance Constructor</a></li></ul></li><li><a href="/dobby/guide/models/crud.html" class="sidebar-link">CRUD</a></li><li><a href="/dobby/guide/models/fields.html" class="sidebar-link">Fields &amp; Attributes</a></li><li><a href="/dobby/guide/models/decorators.html" class="sidebar-link">Field Decorators</a></li><li><a href="/dobby/guide/models/hooks.html" class="sidebar-link">Hooks</a></li><li><a href="/dobby/guide/models/customising-models.html" class="sidebar-link">Customising Models</a></li></ul></section></li><li><section class="sidebar-group depth-0"><a href="/dobby/guide/query-builder/" class="sidebar-heading clickable"><span>Query Builder</span> <!----></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/dobby/guide/query-builder/select-fields.html" class="sidebar-link">Select fields</a></li><li><a href="/dobby/guide/query-builder/query-arguments.html" class="sidebar-link">Arguments</a></li><li><a href="/dobby/guide/query-builder/relationships.html" class="sidebar-link">Relationships</a></li><li><a href="/dobby/guide/query-builder/dynamic-query-operations.html" class="sidebar-link">Dynamic Query Operations</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Advanced</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/dobby/guide/advanced/adapters.html" class="sidebar-link">Adapters</a></li><li><a href="/dobby/guide/advanced/field-builders.html" class="sidebar-link">Field Builders</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="conventions"><a href="#conventions" class="header-anchor">#</a> Conventions</h1> <p>In order to leverage the power of Dobby models, it might be useful to understand some basics.</p> <h2 id="model-key"><a href="#model-key" class="header-anchor">#</a> Model Key</h2> <p>Model keys are similar to model names in that they're used to identify models. By default, you may not define a model with the same name more than once. Using a key identifyie is a way to define multiple models that share the same name but might have different schemas.</p> <p>In some cases, especitially when working with multiple client endpoints, you might need to define multiple models with different schemas.</p> <p>Model 1.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Address</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">modelKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'UserAddress'</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function">fields</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    f<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">'street'</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">'street_extra'</span><span class="token punctuation">)</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Model 2</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Address</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token keyword">get</span> <span class="token function">modelKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'LocationAddress'</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">static</span> <span class="token function">fields</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    f<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">'line1'</span><span class="token punctuation">)</span>
    f<span class="token punctuation">.</span><span class="token function">string</span><span class="token punctuation">(</span><span class="token string">'line2'</span><span class="token punctuation">)</span>
    <span class="token operator">...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Defining the above models at different locations in one application without unique <code>modelKey</code> will cause several schema build errors.</p> <p>With the default adapter, the below will execute a <code>addresses{ id }</code> query for either models.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> addresses <span class="token operator">=</span> <span class="token keyword">await</span> Address<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="primary-keys"><a href="#primary-keys" class="header-anchor">#</a> Primary Keys</h2> <p>Dobby assumes your models have a primary key named <code>id</code>.
When defining your model's primary key, it's recommended to use the <code>ID</code> attribute to automatically make it read-only.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Model <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@moirei/dobby&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> entity <span class="token operator">=</span> <span class="token string">&quot;User&quot;</span><span class="token punctuation">;</span>
  <span class="token keyword">static</span> primaryKey <span class="token operator">=</span> <span class="token string">&quot;handle&quot;</span><span class="token punctuation">;</span>

  <span class="token keyword">static</span> <span class="token function">fields</span><span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    f<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Or</span>
    f<span class="token punctuation">.</span><span class="token function">id</span><span class="token punctuation">(</span><span class="token string">&quot;handle&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;ID&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you need to retrieve the primary key name or value on a model instance, you may use the <code>$getKeyName</code> and <code>$getKey</code> methods.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{</span> handle<span class="token operator">:</span> <span class="token string">&quot;james-franco&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

user<span class="token punctuation">.</span><span class="token function">$getKeyName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns &quot;handle&quot;</span>
user<span class="token punctuation">.</span><span class="token function">$getkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns &quot;james-franco&quot;</span>
</code></pre></div><h2 id="default-selects"><a href="#default-selects" class="header-anchor">#</a> Default Selects</h2> <p>By default, all model attributes are selected in queries. For models with large number of attributes, you might want to limit the number of query fields selected by default. E.g. when using the <code>findMany</code> method. Use the <code>queryAttributes</code> property to specify the default selection.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * Entity name
   */</span>
  <span class="token keyword">static</span> entity <span class="token operator">=</span> <span class="token string">&quot;User&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Attributes to always include in queries by default.
   */</span>
  <span class="token keyword">static</span> queryAttributes<span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="eager-loading"><a href="#eager-loading" class="header-anchor">#</a> Eager Loading</h2> <p>By default, all relationships are excluded in queries. Use the <code>queryRelationships</code> property to automatically include relationships in queries.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * Entity name
   */</span>
  <span class="token keyword">static</span> entity <span class="token operator">=</span> <span class="token string">&quot;User&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Attribute relationships that should be eager-loaded.
   */</span>
  <span class="token keyword">static</span> queryRelationships<span class="token operator">:</span> string<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;posts&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="dynamic-query-operations"><a href="#dynamic-query-operations" class="header-anchor">#</a> Dynamic Query Operations</h2> <p>Enabling dynamic query operations allow you to build and execute queries in style. Assuming you need to perform a query named <code>subscribedUsers</code>, you may not necessarily want to create a new Adapter or hook for this.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token comment">/**
   * Entity name
   */</span>
  <span class="token keyword">static</span> entity <span class="token operator">=</span> <span class="token string">&quot;User&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Allow performing dynamic actions on queries.
   */</span>
  <span class="token keyword">static</span> dynamicQueryOperations<span class="token operator">:</span> boolean <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now, the following query can be called without throwing errors</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">select</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;name&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribedUsers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This will build and execute the following query</p> <div class="language-graphql extra-class"><pre class="language-graphql"><code><span class="token keyword">query</span> <span class="token punctuation">{</span>
  <span class="token object">subscribedUsers</span> <span class="token punctuation">{</span>
    <span class="token property">id</span>
    <span class="token property">name</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Likewise a mutation for <code>subscibeUser</code> can be</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mutation</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscibeUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This will build and execute the following query</p> <div class="language-graphql extra-class"><pre class="language-graphql"><code><span class="token keyword">mutation</span> <span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">:</span> <span class="token scalar">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token property-query">subscibeUser</span><span class="token punctuation">(</span><span class="token attr-name">id</span><span class="token punctuation">:</span> <span class="token variable">$id</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="default-attribute-values"><a href="#default-attribute-values" class="header-anchor">#</a> Default Attribute Values</h2> <p>One of the ways to define default values in using the model's <code>original</code> attributes bucket. When you create or retrieve a model, the raw values of the retrieved fields are stored here.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> entity <span class="token operator">=</span> <span class="token string">'User'</span><span class="token punctuation">;</span>

  <span class="token keyword">protected</span> original <span class="token operator">=</span> <span class="token punctuation">{</span>
    email_verified<span class="token operator">:</span> <span class="token boolean">false</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><blockquote><p>Avoid setting default values to primary keys.</p></blockquote> <p>Defaults can also be set at the field definition level.</p> <h2 id="maximum-query-depth"><a href="#maximum-query-depth" class="header-anchor">#</a> Maximum Query Depth</h2> <p>With eager loading enabled, related models are automatically included to queries. By default this is limited to 3 degrees.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> entity <span class="token operator">=</span> <span class="token string">&quot;User&quot;</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * The maximum query depth.
   * Used to limit nested included relationships.
   */</span>
  <span class="token keyword">static</span> maxQueryDepth <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This is ignored when relationships are included manually.</p> <h2 id="make-arguments-required-by-default"><a href="#make-arguments-required-by-default" class="header-anchor">#</a> Make Arguments Required by Default</h2> <p>By default, anonymous variables are automatically parsed. That is, the following query will consider <code>id</code> to be an optional variable.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mutate</span><span class="token punctuation">(</span><span class="token string">&quot;subscibeUser&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-graphql extra-class"><pre class="language-graphql"><code><span class="token keyword">mutation</span> <span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">:</span> <span class="token scalar">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token property-query">subscibeUser</span><span class="token punctuation">(</span><span class="token attr-name">id</span><span class="token punctuation">:</span> <span class="token variable">$id</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>To make all anonyous variables required by default, set the <code>argumentRequiredByDefault</code> property to <code>true</code>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> entity <span class="token operator">=</span> <span class="token string">'User'</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Make auto-resolved argument types required by default.
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> readonly argumentRequiredByDefault <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Now the above mutation with produce a slightly deferent query</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mutate</span><span class="token punctuation">(</span><span class="token string">&quot;subscibeUser&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-graphql extra-class"><pre class="language-graphql"><code><span class="token keyword">mutation</span> <span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">:</span> <span class="token scalar">Int</span><span class="token operator">!</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token property-query">subscibeUser</span><span class="token punctuation">(</span><span class="token attr-name">id</span><span class="token punctuation">:</span> <span class="token variable">$id</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Note that anonymous variables is only allowed for primitive types.</p> <h2 id="fetch-policy"><a href="#fetch-policy" class="header-anchor">#</a> Fetch Policy</h2> <p>Models can configure their fetch policy for Apollo Client. By default this is set to <code>no-cache</code>. Fetch policies can also be changes at the query level.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Model</span><span class="token punctuation">{</span>
  <span class="token keyword">static</span> entity <span class="token operator">=</span> <span class="token string">'User'</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * The default fetch policy for the model.
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">static</span> readonly fetchPolicy <span class="token operator">=</span> <span class="token string">&quot;network-only&quot;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>User<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">policy</span><span class="token punctuation">(</span><span class="token string">&quot;cache-and-network&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="attribute-changes"><a href="#attribute-changes" class="header-anchor">#</a> Attribute Changes</h2> <p>Dobby provides <code>$isDirty</code> and <code>$isClean</code> methods to help check the state of the a model instance compared to its initiate state when the model was retrieved or created.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> User<span class="token punctuation">.</span><span class="token function">findUnqiue</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">;</span>

user<span class="token punctuation">.</span><span class="token function">$isDirty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
user<span class="token punctuation">.</span><span class="token function">$isDirty</span><span class="token punctuation">(</span><span class="token string">&quot;name&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// true</span>
user<span class="token punctuation">.</span><span class="token function">$isDirty</span><span class="token punctuation">(</span><span class="token string">&quot;email&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
user<span class="token punctuation">.</span><span class="token function">$isClean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>

<span class="token keyword">await</span> user<span class="token punctuation">.</span><span class="token function">$save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span><span class="token function">$isDirty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><p>To include dirty state of related models, use the <code>$isDeepDirty</code> method.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">$isDeepDirty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//</span>
<span class="token punctuation">}</span>
</code></pre></div><p>If you would like to keep the changes without calling <code>$save</code>, you can use the <code>$keepChanges</code> method.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>user<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;John&quot;</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span><span class="token function">$keepChanges</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
user<span class="token punctuation">.</span><span class="token function">$isDirty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// false</span>
</code></pre></div><h2 id="copying-and-hydration"><a href="#copying-and-hydration" class="header-anchor">#</a> Copying and Hydration</h2> <p>It is possible to define a model and later hydrate its content with a query result.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> user1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">&quot;Joe Blow&quot;</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> user2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>This will perform a <code>findUnique</code> operation under the hood and then copy its results.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">await</span> user2<span class="token punctuation">.</span><span class="token function">$hydrateWith</span><span class="token punctuation">(</span><span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>The <code>$hydrateWith</code> method supports arguments similar to the <code>findUnique</code> method.</p> <p>Now that <code>user2</code> is hydrate, its content can also be copied to <code>user1</code>.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>user1<span class="token punctuation">.</span><span class="token function">$copy</span><span class="token punctuation">(</span>user2<span class="token punctuation">)</span><span class="token punctuation">;</span>

user1<span class="token punctuation">.</span>id<span class="token punctuation">;</span> <span class="token comment">// returns &quot;2&quot;</span>
user1<span class="token punctuation">.</span>name<span class="token punctuation">;</span> <span class="token comment">// returns &quot;John Doe&quot;</span>
</code></pre></div><h2 id="comparing-models"><a href="#comparing-models" class="header-anchor">#</a> Comparing Models</h2> <p>Dobby provides methods <code>$is</code> and <code>$isNot</code> to quickly compare models. It compares the Model keys and primary keys.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">$is</span><span class="token punctuation">(</span>anotherUser<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//</span>
<span class="token punctuation">}</span>

<span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">$isNot</span><span class="token punctuation">(</span>anotherUser<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">//</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="retrieving-instance-constructor"><a href="#retrieving-instance-constructor" class="header-anchor">#</a> Retrieving Instance Constructor</h2> <p>For convenience, model instances can retrieve their constructor with the provided <code>$self</code> method.</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

user<span class="token punctuation">.</span><span class="token function">$self</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// returns &quot;class User extends Model{..}&quot;</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/dobby/guide/models/define-models.html" class="prev">
        Defining Models
      </a></span> <span class="next"><a href="/dobby/guide/models/crud.html">
        CRUD
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/dobby/assets/js/app.d1fa0665.js" defer></script><script src="/dobby/assets/js/2.0c3bff11.js" defer></script><script src="/dobby/assets/js/11.ba11236c.js" defer></script>
  </body>
</html>
